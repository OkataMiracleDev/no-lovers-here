# MongoDB Atlas Setup Guide

## üöÄ Quick Setup (5 minutes)

### Step 1: Create MongoDB Atlas Account
1. Go to https://www.mongodb.com/cloud/atlas
2. Click "Try Free"
3. Sign up with email or Google
4. Choose "Free" tier (M0 Sandbox)

### Step 2: Create a Cluster
1. After signup, you'll be prompted to create a cluster
2. Choose:
   - **Cloud Provider:** AWS (or any)
   - **Region:** Choose closest to your users
   - **Cluster Tier:** M0 Sandbox (FREE)
   - **Cluster Name:** Leave default or name it "no-lovers-here"
3. Click "Create Cluster" (takes 3-5 minutes)

### Step 3: Create Database User
1. Click "Database Access" in left sidebar
2. Click "Add New Database User"
3. Choose "Password" authentication
4. Set username: `admin` (or your choice)
5. Click "Autogenerate Secure Password" (copy it!)
6. Database User Privileges: "Read and write to any database"
7. Click "Add User"

**Important:** Save your password! You'll need it for the connection string.

### Step 4: Allow Network Access
1. Click "Network Access" in left sidebar
2. Click "Add IP Address"
3. Choose "Allow Access from Anywhere" (for deployment)
   - This adds `0.0.0.0/0` (required for Vercel/Render)
4. Click "Confirm"

### Step 5: Get Connection String
1. Click "Database" in left sidebar
2. Click "Connect" on your cluster
3. Choose "Connect your application"
4. Driver: Node.js, Version: 5.5 or later
5. Copy the connection string (looks like):
   ```
   mongodb+srv://admin:<password>@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
   ```
6. Replace `<password>` with your actual password
7. Add database name before the `?`:
   ```
   mongodb+srv://admin:yourpassword@cluster0.xxxxx.mongodb.net/nolovershere?retryWrites=true&w=majority
   ```

### Step 6: Update Your .env File
```bash
DATABASE_URL="mongodb+srv://admin:yourpassword@cluster0.xxxxx.mongodb.net/nolovershere?retryWrites=true&w=majority"
```

### Step 7: Push Database Schema
```bash
# Windows PowerShell
$env:DATABASE_URL="your-mongodb-connection-string"
npm run db:push
```

You should see:
```
‚úî Generated Prisma Client
Your database is now in sync with your Prisma schema.
```

---

## ‚úÖ Verify Setup

### Test Connection Locally:
```bash
npm run db:studio
```

This should open Prisma Studio at http://localhost:5555

---

## üîß Troubleshooting

### Error: "Authentication failed"
- Check your password is correct in connection string
- Ensure password doesn't contain special characters (or URL encode them)
- Verify database user was created

### Error: "IP not whitelisted"
- Go to Network Access
- Add `0.0.0.0/0` to allow all IPs
- Wait 1-2 minutes for changes to apply

### Error: "Could not connect to server"
- Check your internet connection
- Verify cluster is running (not paused)
- Ensure connection string format is correct

### Special Characters in Password
If your password has special characters, URL encode them:
- `@` ‚Üí `%40`
- `#` ‚Üí `%23`
- `$` ‚Üí `%24`
- `%` ‚Üí `%25`
- `&` ‚Üí `%26`

Example:
```
Password: P@ss#123
Encoded: P%40ss%23123
```

---

## üìä MongoDB Atlas Free Tier Limits

**M0 Sandbox (Free Forever):**
- 512 MB storage
- Shared RAM
- Shared vCPU
- No backup
- Perfect for development and small apps

**Upgrade to M10 ($0.08/hour) when you need:**
- More storage
- Dedicated resources
- Automated backups
- Better performance

---

## üîê Security Best Practices

### 1. Strong Password
- Use autogenerated password
- Don't use common words
- Store securely (password manager)

### 2. Network Access
- For production, consider restricting IPs
- For Vercel/Render, `0.0.0.0/0` is required

### 3. Database User Permissions
- Use "Read and write to any database" for app
- Create separate admin user for management

### 4. Connection String
- Never commit to Git
- Store in environment variables
- Use different databases for dev/prod

---

## üöÄ Deploy with MongoDB Atlas

### For Vercel:
1. Go to Vercel project settings
2. Environment Variables
3. Add `DATABASE_URL` with your MongoDB connection string
4. Deploy

### For Render:
1. Go to Render service settings
2. Environment Variables
3. Add `DATABASE_URL` with your MongoDB connection string
4. Deploy

**Important:** Both platforms support MongoDB Atlas out of the box!

---

## üìà Monitoring Your Database

### View Data:
1. MongoDB Atlas Dashboard ‚Üí Database ‚Üí Browse Collections
2. Or use Prisma Studio: `npm run db:studio`

### Monitor Usage:
1. MongoDB Atlas Dashboard ‚Üí Metrics
2. Check storage usage
3. Monitor connections
4. View operations

### Set Alerts:
1. MongoDB Atlas Dashboard ‚Üí Alerts
2. Set up email alerts for:
   - Storage reaching limit
   - High connection count
   - Unusual activity

---

## üîÑ Database Migrations

### When You Change Schema:
```bash
# Update database
npm run db:push

# Or for production
npx prisma db push
```

### View Current Schema:
```bash
npx prisma studio
```

---

## üí° Pro Tips

### 1. Use Different Databases for Environments
```bash
# Development
DATABASE_URL="mongodb+srv://...mongodb.net/nolovershere-dev?..."

# Production
DATABASE_URL="mongodb+srv://...mongodb.net/nolovershere-prod?..."
```

### 2. Connection Pooling
MongoDB Atlas handles this automatically. No config needed!

### 3. Backup Your Data
Free tier doesn't include backups. For production:
- Upgrade to M10+ for automated backups
- Or manually export data regularly

### 4. Monitor Performance
- Check "Performance Advisor" in Atlas
- Review slow queries
- Add indexes as needed (Prisma handles most)

---

## üÜò Need Help?

### MongoDB Atlas Support:
- Docs: https://docs.atlas.mongodb.com
- Community: https://www.mongodb.com/community/forums
- Support: https://support.mongodb.com

### Prisma with MongoDB:
- Docs: https://www.prisma.io/docs/concepts/database-connectors/mongodb
- Issues: https://github.com/prisma/prisma/issues

---

## ‚úÖ Setup Complete!

Your MongoDB Atlas database is ready. Next steps:

1. ‚úÖ Connection string obtained
2. ‚úÖ Added to `.env`
3. ‚úÖ Schema pushed with `npm run db:push`
4. ‚úÖ Ready to deploy!

**Continue with deployment:**
- Vercel: See `VERCEL_DEPLOYMENT.md`
- Render: See `RENDER_DEPLOYMENT.md`
